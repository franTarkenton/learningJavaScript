<!DOCTYPE html>
<meta charset="utf-8">
<style>
    body {
        font: 19px sans-serif;
    }

    .arc path {
        stroke: #fff;
    }

</style>
<body> 
    <div id='start'>hello</div>
    <!-- <script src="http://d3js.org/d3.v3.min.js"></script> -->    <script src="../lib/OpenLayers.js"></script>

    <script>
        OpenLayers.ProxyHost = "/cgi-bin/proxy.cgi?url=";

        /// shows what I want to do: http://wygoda.net/blog/wfs-without-map-with-openlayers
        // need to see if I can put together a manual query to a wfs layer
        wfsProtocolParams = {
            url : "http://subban.no-ip.biz/geoserver/wfs",
            version : "1.1.0",
            featureType : "mule_deer",
            featurePrefix : 'cum_effects',
            srsName : 'EPSG:900913'
        };
        protocol = new OpenLayers.Protocol.WFS(wfsProtocolParams);
        // then protocol.read()
        attributeFilter = new OpenLayers.Filter.Comparison({
                    type : OpenLayers.Filter.Comparison.NOT_EQUAL_TO,
                    property : 'RISK',
                    value : 'NOT APPLICABLE'
            });
                
        // next spatial filter, and combine with the filter above
        polygonDrawn = 'POLYGON((-13445733.370537 6369380.0116477,-13443019.856033 6369571.1042184,-13442331.922779 6367354.4303985,-13444816.126198 6366972.2452571,-13445733.370537 6369380.0116477))'; 
        spatialFilterParams =  {
            type : OpenLayers.Filter.Spatial.INTERSECTS,
            value : polygonDrawn,
            projection : new OpenLayers.Projection('EPSG:900913')
        };
        filter_spatial = new OpenLayers.Filter.Spatial(spatialFilterParams);
        combinedFilter = new OpenLayers.Filter.Logical({
                            filters : [attributeFilter, filter_spatial],
                            type : OpenLayers.Filter.Logical.AND
                        });
        
        protocol.read({
            filter: combinedFilter, 
            callback: function(response) {
                console.log("callback called");
                console.log("response.features" + response.features);
            if(response.features.length > 0) {
                console.log(response.features);
            } else {
                console.log('Whoops, no features returned!');
            }
        }
        });
        console.log("here");
    </script>
</body> 
